;function HomeBannerModel(){var a=this;a.IntervalId,a.HomeBannerHover=!1,a.SlideTime,a.IsInterval,a.CycleImage=function(){if(!a.HomeBannerHover){var b=$(".image_thumb ul li:last").hasClass("active"),c=$(".image_thumb ul li.active");if(b)var d=$(".image_thumb ul li:first");else var d=$(".image_thumb ul li.active").next();$(c).removeClass("active"),$(d).addClass("active"),$(".arrow-current").remove(),$(".image_thumb ul li.active").append('<div class="arrow-current"></div>');var e=$(d).find("img").attr("alt"),f=$(d).find("a").attr("href"),g=$(d).find(".block .lst-left-thumb-img-container").html();$(".main_image").animate({opacity:0},750,function(){$(".main_image .block").html(g),$(".main_image .big-img").attr({src:f,alt:e}),$(".main_image").animate({opacity:1},1e3),$(".left-thumb-img a").fancybox({prevEffect:"fade",nextEffect:"fade",openEffect:"fade"})})}},a.SlideBanner=function(){a.IsInterval&&(a.IntervalId=setInterval(a.CycleImage,a.SlideTime)),$(".main_image .desc").show(),$(".main_image .block").animate({opacity:1},1),$(".image_thumb ul li:first").addClass("active"),$(".image_thumb ul li:first").append('<div class="arrow-current"></div>'),$(".image_thumb ul li").click(function(){var a=$(this).find("img").attr("alt"),b=$(this).find("a").attr("href"),c=$(this).find(".block .lst-left-thumb-img-container").html();return $(this).is(".active")?!1:($(".main_image").animate({opacity:0},750,function(){$(".main_image .block").html(c),$(".main_image .big-img").attr({src:b,alt:a}),$(".main_image").animate({opacity:1},1e3),$(".left-thumb-img a").fancybox({prevEffect:"fade",nextEffect:"fade",openEffect:"fade"})}),$(".image_thumb ul li").removeClass("active"),$(this).addClass("active"),$(".arrow-current").remove(),$(".image_thumb ul li.active").append('<div class="arrow-current"></div>'),!1)}).hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("a.collapse").click(function(){$(".main_image .block").slideToggle(),$("a.collapse").toggleClass("show")}),$("#home-banner-1-2-main").hover(function(){a.HomeBannerHover=!0},function(){a.HomeBannerHover=!1})},a.Init=function(b){var c={slideTime:15e3,isInterval:!0};b=$.extend({},c,b),a.SlideTime=b.slideTime,a.IsInterval=b.isInterval,a.SlideBanner()}}
;(function(){function a(a,b,c,d,e,f){function h(b,d){b!=1,c.IsLoadingPre=!0;var f="/__get/Video/HomeVideo";f+=e.GetParamRnd(f),f+="&"+e.GetUrlParams({count:12,type:c.Type,cateId:c.CateId,cityId:c.CityId}),a.get(f).success(function(a){if(!a){c.IsLoadingPre=!1;return}c.Group=a.Groups[0],d(a)}).error(function(a){e.Log(a),c.IsLoadingPre=!1})}function i(a,b,d){a==1&&(c.Groups=[],c.$parent.IsFirstLoad==0&&c.ScrollTop()),c.$parent.IsFirstLoad=!1,c.CateId=b.CateId,c.CityId=b.CityId;for(var f=0;f<b.Groups.length;f++)c.Groups.push(b.Groups[f]);c.DefaultTotal=c.Groups[0].Items.length,c.ExcludeIds=c.Groups[0].ExcludeIds,e.RunFnc(d,b)}function j(b,d){c.IsLoading=!0;var f="/__get/Video/HomeVideoGroup";c.IsFirstLoadMore||b.Count%3!=0&&(b.Count=b.Count+3-b.Count%3),f+=e.GetParamRnd(f),f+="&"+e.GetUrlParams({count:b.Count,lastId:b.LastId,groupId:b.Id,cateId:c.CateId,cityId:c.CityId,type:c.Type,excludeIds:c.ExcludeIds}),a.get(f).success(function(a){if(!a){c.IsLoading=!1;return}c.IsFirstLoadMore=!1,d(a)}).error(function(a){e.Log(a),c.IsLoading=!1})}function k(a,b,d){a.Count=b.Count,a.LastId=b.LastId,a.Total=b.Total;for(var f=0;f<b.Items.length;f++)a.Items.push(b.Items[f]);c.LoadMoreTotal=b.Total,e.RunFnc(d,b)}var g=this;g.$scope=c,c.MenuId=d.MenuId?d.MenuId:1,c.Type=d.type?d.type:1,c.CateId=null,c.CityId=null,c.IsFirstLoadMore=!0,c.Groups=[],c.Group={},c.LoadMoreCount=0,c.DefaultTotal=0,c.LoadMoreTotal=0,c.LoadMoreFirst=!0,c.ExcludeIds="",c.IsLoading=!1,c.IsLoadingPre=!1,c.PreloadList=[1,2,3,4,5,6],c.IsLoadMore=function(a){return a.Total-a.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();e.ScrollShowTop(a,-b)},c.Init=function(a){if(!a)return;c.ChangeType(a.Type)},c.LoadDataType=function(a,b){if(c.IsLoading==1)return;c.IsLoadingPre=!0,h(a,function(d){i(a,d,function(){c.IsLoadingPre=!1,e.RunFnc(b),c.LoadMoreByGroup(c.Group),c.LoadMoreFirst=!1})})},c.LoadMoreByGroup=function(a,b){c.LoadMoreCount>=5?f.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading==1)return;c.IsLoading=!0,j(a,function(d){k(a,d,function(){c.IsLoading=!1,e.RunFnc(b)})})},c.Filter=function(){c.LoadDataType(!0)},c.ChangeType=function(a){c.Type=a,c.LoadDataType(!0)},c.LoadDataType(!0),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.IsLoading==0&&(c.LoadMoreFirst?(c.LoadMoreByGroup(c.Group),c.LoadMoreFirst=!1):c.DefaultTotal+c.LoadMoreTotal>c.Group.Items.length&&c.LoadMoreCount<5&&(c.LoadMoreByGroup(c.Group),c.LoadMoreCount++))}),c.ClickGA=function(a,b){window.ga&&a.IsAds&&ga("ads.send","event",b,"Click",a.Title)},c.ImpressionGa=function(a,b){window.ga&&a.IsAds&&ga("ads.send","event",b,"Impression",a.Title)}}"use strict",angular.module("FoodyApp").controller("VideoCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","Helper","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f){function h(b,d){var f=(new Date).getTime(),g="/__post/Review/HomeLoadMore",h=(g?g.indexOf("?")>-1?"&":"?":"")+"t="+f;b==1&&(c.LastId=null,c.Count=10),a.post(g+h,{LastId:c.LastId,Count:c.Count,Type:c.Filter.Type}).success(function(a){e.RunFnc(d,a)}).error(function(){e.RunFnc(d)})}function i(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad==0&&c.ScrollTop(),c.LoadMoreCount=0),c.$parent.IsFirstLoad=!1,c.Count=b.Count,c.LastId=b.LastId,c.Total=b.Total;var f=b.Items;for(var g=0;g<f.length;g++){var h=f[g];h.UrlLoad=c.UrlImgBg,c.Items.push(h)}e.RunFnc(d,b)}function j(){var a=g.ListLazyPics,b=$(window).scrollTop();for(var d=0;d<a.length;d++){var e=a[d].ele.offset();e.top<b+500&&(a[d].$scope.ShowLazyPic(),c.$$phase||c.$apply(),a.splice(d,1))}}var g=this;c.MenuId=d.MenuId?d.MenuId:1,g.ListLazyPics=[],g.$scope=c,c.Count=10,c.LastId=null,c.Total=0,c.Items=[],c.Model={},c.Filter={Type:"1"},c.PreloadList=[1,2],c.LoadMoreCount=0,c.IsLoading=!1,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.AddLazyLoadPic=function(a){g.ListLazyPics.push(a)},c.Init=function(a){a=window[a];if(!a)return;c.Count=a.Count?a.Count:10,c.LastId=a.LastId,c.Total=a.Total,c.UrlImgBg=a.UrlImgBg;var b=a.Items;if(b)for(var d=0;d<b.length;d++){var e=b[d];e.UrlLoad=c.UrlImgBg,c.Items.push(e)}else c.LoadMore(!0);$(window).scroll(function(){g._timeOut&&clearTimeout(g._timeOut),g._timeOut=setTimeout(j,100)})},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();e.ScrollShowTop(a,-b)},c.ChangeType=function(a){c.Filter.Type=a,c.Items=[],c.LoadMore(!0)},c.LoadMore=function(a,b){c.LoadMoreCount>=5?f.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading==1)return;c.IsLoading=!0,h(a,function(d){i(a,d,function(){setTimeout(j,1e3),c.IsLoading=!1,a!=1,e.RunFnc(b)})})},c.LoadMore(!0),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.IsLoading==0&&c.LoadMoreCount<5&&c.IsLoadMore()==1&&c.LoadMore(!1,function(){c.LoadMoreCount++})})}"use strict",angular.module("FoodyApp").controller("HomeReviewCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","Helper","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f,g,h,i){function k(b,d){b==1&&(c.Count=12,c.LastId=null),c.IsLoading=!0;var e="/__get/MemberCard/HomeLoadMore";e+=f.GetParamRnd(e),c.IsReputation=c.IsReputation===!1?"":c.IsReputation,e+="&"+f.GetUrlParams({count:c.Count,lastId:c.LastId,sortType:c.SortType,cityId:c.CityId}),a.get(e).success(function(a){if(!a){c.IsLoading=!1;return}d(a)}).error(function(a){f.Log(a),c.IsLoading=!1})}function l(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad===!1&&c.ScrollTop()),c.$parent.IsFirstLoad=!1,c.Count=b.Count,c.LastId=b.LastId,c.CityId=b.CityId,c.Total=b.Total;for(var e=0;e<b.Items.length;e++)c.Items.push(b.Items[e]);f.RunFnc(d,b)}var j=this;j.$scope=c,c.MenuId=d.MenuId?d.MenuId:1,c.SortType=1,c.Count=12,c.LastId=null,c.Total=0,c.LoadMoreCount=0,c.CityId="",c.Items=[],c.PreloadList=[1,2,3,4,5,6],c.IsLoading=!1,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();f.ScrollShowTop(a,-b)},c.Init=function(a){if(!a)return;c.ChangeType(a.Type)},c.LoadMore=function(a,b){c.LoadMoreCount>=5?i.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading===!0)return;c.IsLoading=!0,k(a,function(d){l(a,d,function(){c.IsLoading=!1,f.RunFnc(b)})})},c.Filter=function(){c.LoadMore(!0)},c.ChangeType=function(a){c.SortType=a,c.Items=[],c.LoadMore(!0)},c.ShowCondition=function(a){a.Note!=null?e.Show({Content:a.Note}):e.Show({Content:ECardText.NoConditionsApply})},c.LoadMore(!0),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.IsLoading===!1&&c.IsLoadMore()===!0&&c.LoadMoreCount<5&&(c.LoadMore(),c.LoadMoreCount++)}),c.ShowPopupGallery=function(a){g.Show(a)},c.ShowPopupReviews=function(a){h.Show(a)}}"use strict",angular.module("FoodyApp").controller("HomeECardCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","DlgCommon","Helper","DlgGallery","DlgReviews","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f,g,h,i){function k(b,d){b==1&&(c.Count=12,c.LastId=null),c.IsLoading=!0;var e="/__get/BankCard/LoadMoreResBankCard";e+=f.GetParamRnd(e),c.IsReputation=c.IsReputation==0?"":c.IsReputation,e+="&"+f.GetUrlParams({bankId:c.Bank!=null?c.Bank.Id:null,resName:c.ResName,count:12,lastId:c.LastId}),a.get(e).success(function(a){if(!a){c.IsLoading=!1;return}d(a)}).error(function(a){f.Log(a),c.IsLoading=!1})}function l(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad==0&&c.ScrollTop()),c.$parent.IsFirstLoad=!1,c.Count=12,c.LastId=b.lastId,c.Total=b.total;for(var e=0;e<b.items.length;e++)b.items[e].BankName=b.items[e].ListDiscounts[0].BankName,b.items[e].Discount=b.items[e].ListDiscounts[0].Discount+"%",b.items[e].Policy=b.items[e].ListDiscounts[0].Policy,c.Items.push(b.items[e]);f.RunFnc(d,b)}var j=this;j.$scope=c,c.MenuId=d.MenuId?d.MenuId:1,c.Count=12,c.LastId=null,c.Total=0,c.LoadMoreCount=0,c.Items=[],c.ListBank=[],c.PreloadList=[1,2,3,4,5,6],c.ResName="",c.IsLoading=!1,c.Bank=null,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();f.ScrollShowTop(a,-b)},a.get("/__get/BankCard/GetListBank").success(function(a){c.ListBank=a.data}).error(function(a){f.Log(a)}),c.LoadMore=function(a,b){c.LoadMoreCount>=5?i.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading==1)return;c.IsLoading=!0,k(a,function(d){l(a,d.data,function(){c.IsLoading=!1,f.RunFnc(b)})})},c.LoadMore(!0),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.ShowPopupGallery=function(a){g.Show(a)},c.ShowPopupReviews=function(a){h.Show(a)},document.getElementById("txtResName").onkeyup=function(a){m(function(){c.LoadMore(!0)},300)};var m=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}();c.$on("main.scroll",function(a,b){c.IsLoading==0&&c.IsLoadMore()==1&&c.LoadMoreCount<5&&(c.LoadMore(!1),c.LoadMoreCount++)})}"use strict",angular.module("FoodyApp").controller("HomeBankCardCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","DlgCommon","Helper","DlgGallery","DlgReviews","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f,g,h,i){function k(b,d){b==1&&(c.NextItemId=0),c.IsLoading=!0;var e="/__get/Promotion/HomeLoadMore";e+=f.GetParamRnd(e),e+="&"+f.GetUrlParams({locationId:c.LocationId,categoryId:c.CateId,nextItemId:c.NextItemId,pageSize:c.PageSize,getType:c.GetType}),a.get(e).success(function(a){if(!a){c.IsLoading=!1;return}d(a)}).error(function(a){f.Log(a),c.IsLoading=!1})}function l(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad==0&&c.ScrollTop()),c.$parent.IsFirstLoad=!1,c.NextItemId=b.NextItemId,c.LocationId=b.LocationId,c.CategoryId=b.CategoryId,a==1&&(c.Total=b.TotalCount+b.Items.length);for(var e=0;e<b.Items.length;e++)c.Items.push(b.Items[e]);c.GetType==1&&c.Items.length==0&&(c.HideFeatured=!0,c.ChangeGetType(2)),f.RunFnc(d,b)}function m(){c.$$phase||c.$apply()}var j=this;j.$scope=c,c.MenuId=d.MenuId?d.MenuId:1,c.GetType=1,c.PageSize=12,c.NextItemId=0,c.Total=0,c.LocationId=0,c.LoadMoreCount=0,c.CateId=0,c.Items=[],c.PreloadList=[1,2,3,4,5,6],c.IsLoading=!1,c.HideFeatured=!1,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();f.ScrollShowTop(a,-b)},c.Init=function(){c.ChangeCate(1)},c.LoadMore=function(a,b){c.LoadMoreCount>=5?i.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading==1)return;c.IsLoading=!0,k(a,function(d){l(a,d,function(){c.IsLoading=!1,f.RunFnc(b)})})},c.ChangeGetType=function(a){c.GetType=a,c.Items=[],c.LoadMore(!0)},c.ChangeGetType(1),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.IsLoading==0&&c.IsLoadMore()==1&&c.LoadMoreCount<5&&(c.LoadMore(),c.LoadMoreCount++)}),c.ShowPopupGallery=function(a){g.Show(a)},c.ShowPopupReviews=function(a){h.Show(a)}}"use strict",angular.module("FoodyApp").controller("HomePromotionCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","DlgCommon","Helper","DlgGallery","DlgReviews","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f){function h(b,d){b==1&&(c.Count=12,c.LastId=null),c.IsLoading=!0;var f="/__get/Article/LoadMore";f+=e.GetParamRnd(f),f+="&"+e.GetUrlParams({count:c.Count,lastId:c.LastId,cateId:c.CateId,sortType:c.SortType,cityId:c.CityId,excludeIds:c.ExcludeIds,featuredCount:12}),a.get(f).success(function(a){if(!a){c.IsLoading=!1;return}d(a)}).error(function(a){e.Log(a),c.IsLoading=!1})}function i(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad==0&&b.Items.length>0&&c.ScrollTop()),c.$parent.IsFirstLoad=!1,c.Count=b.Count,c.LastId=b.LastId,c.CityId=b.CityId,c.ExcludeIds=b.ExcludeIds,c.Total=b.Total;for(var f=0;f<b.Items.length;f++)c.Items.push(b.Items[f]);c.CateId==0&&c.Items.length>0?c.HasFeatured=1:c.CateId==0&&c.Items.length==0&&(c.HasFeatured=0,c.CateId=c.ListCate[0]!=undefined?c.ListCate[0].Id:0,c.LoadMore(!0)),b.Items.length==0&&(c.HasNoItem=!0),e.RunFnc(d,b)}var g=this;c.ListCate=window.initCate,c.MenuId=d.MenuId?d.MenuId:1,c.Cate=d.cate?d.cate:"food",c.CateId=1,c.SortType="2",c.Count=12,c.HasFeatured=0,c.LastId=null,c.CityId=null,c.ExcludeIds=null,c.Total=0,c.Items=[],c.PreloadList=[1,2,3,4,5,6],c.LoadMoreCount=0,c.IsLoading=!1,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();e.ScrollShowTop(a,-b)},c.Init=function(a){if(!a)return;c.HasNoItem=!1,c.ChangeCateId(a.CateId)},c.LoadMore=function(a,b){c.LoadMoreCount>=5?f.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){c.IsLoading=!0,h(a,function(d){i(a,d,function(){c.IsLoading=!1,e.RunFnc(b)})})},c.Filter=function(){c.LoadMore(!0)},c.ChangeCateId=function(a){c.CateId=a,c.Items=[],c.LoadMore(!0)},b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.IsLoading==0&&c.IsLoadMore()==1&&c.CateId!=0&&c.LoadMoreCount<5&&(c.LoadMore(),c.LoadMoreCount++)}),c.ClickGA=function(a,b){window.ga&&a.IsAds&&ga("ads.send","event",b,"Click",a.Title)},c.ImpressionGa=function(a,b){window.ga&&a.IsAds&&ga("ads.send","event",b,"Impression",a.Title)}}"use strict",angular.module("FoodyApp").controller("HomeArticleCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","Helper","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f){function h(b,d){b==1&&(c.Count=12,c.LastId=null,c.ExcludeIds=null,c.LoadMoreCount=0),c.IsLoading=!0;var f="/__get/Gallery/HomePhoto";f+=e.GetParamRnd(f),c.IsReputation=c.IsReputation==0?"":c.IsReputation,f+="&"+e.GetUrlParams({count:c.Count,lastId:c.LastId,type:c.Type,cityId:c.CityId,cateGroupId:c.CateGroupId,excludeIds:c.ExcludeIds}),a.get(f).success(function(a){if(!a){c.IsLoading=!1;return}d(a)}).error(function(a){e.Log(a),c.IsLoading=!1})}function i(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad==0&&c.ScrollTop(),c.LoadMoreCount=0),c.$parent.IsFirstLoad=!1,c.Count=b.Count,c.LastId=b.LastId,c.Total=b.Total,c.CityId=b.CityId,c.CateGroupId=b.CateGroupId,c.ExcludeIds=b.ExcludeIds;for(var f=0;f<b.Items.length;f++)c.Items.push(b.Items[f]);e.RunFnc(d,b)}var g=this;g.$scope=c,c.MenuId=d.MenuId?d.MenuId:1,c.Type=d.type?d.type:1,c.Count=12,c.LastId=null,c.Total=0,c.LoadMoreCount=0,c.Items=[],c.PreloadList=[1,2,3,4,5,6],c.IsLoading=!1,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();e.ScrollShowTop(a,-b)},c.Init=function(a){if(!a)return;c.ChangeType(a.Type)},c.LoadMore=function(a,b){c.LoadMoreCount>=5?f.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading==1)return;c.IsLoading=!0,h(a,function(d){i(a,d,function(){c.IsLoading=!1,e.RunFnc(b)})})},c.Filter=function(){c.LoadMore(!0)},c.ChangeType=function(a){c.Type=a,c.Items=[],c.LoadMore(!0)},c.LoadMore(!0),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.IsLoading==0&&c.LoadMoreCount<5&&c.IsLoadMore()==1&&c.LoadMore(!1,function(){c.LoadMoreCount++})}),c.ClickGA=function(a,b,c){window.ga&&a.IsAds&&(c+1)%2==0&&ga("ads.send","event",b+(c+1),"Click",a.ResName)},c.ImpressionGa=function(a,b,c){window.ga&&a.IsAds&&(c+1)%2==0&&ga("ads.send","event",b+(c+1),"Impression",a.ResName)},c.ClearCache=function(){if(!confirm("Are you sure want to clear cache?"))return;$.post("/Gallery/ClearCacheHomePhoto",{},function(a){a==1?window.location.reload():alert("can not clear cache now!")}).error(function(a){alert("server error!")})},c.HideToggle=function(a){$.post("/Gallery/HideHomePhoto",{ResPicId:a},function(b){$('.content-item a[data-item="'+a+'"].btn-cmd.btn-hide').toggle(),$('.content-item a[data-item="'+a+'"].btn-cmd.btn-show').toggle()})}}"use strict",angular.module("FoodyApp").controller("PhotoCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","Helper","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f){function h(b,d){b==1&&(c.Count=12,c.LastId=null,c.ExcludeIds=""),c.IsLoading=!0;var f="/__get/List/HomeList";f+=e.GetParamRnd(f),f+="&"+e.GetUrlParams({count:c.Count,lastId:c.LastId,type:c.Type,cityId:c.CityId,excludeIds:c.ExcludeIds}),a.get(f).success(function(a){if(!a){c.IsLoading=!1;return}d(a)}).error(function(a){e.Log(a),c.IsLoading=!1})}function i(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad==0&&c.ScrollTop()),c.$parent.IsFirstLoad=!1,c.Count=b.Count,c.LastId=b.LastId,c.CityId=b.CityId,c.ExcludeIds=b.ExcludeIds,c.Total=b.Total;for(var f=0;f<b.Items.length;f++)c.Items.push(b.Items[f]);e.RunFnc(d,b)}var g=this;g.$scope=c,c.MenuId=d.MenuId?d.MenuId:1,c.Type=d.type?d.type:2,c.CityId="",c.ExcludeIds="",c.Count=12,c.LastId=null,c.Total=0,c.LoadMoreCount=0,c.Items=[],c.PreloadList=[1,2,3,4,5,6],c.IsLoading=!1,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();e.ScrollShowTop(a,-b)},c.Init=function(a){if(!a)return;c.ChangeType(a.Type)},c.LoadMore=function(a,b){c.LoadMoreCount>=5?f.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading==1)return;c.IsLoading=!0,h(a,function(d){i(a,d,function(){c.IsLoading=!1,e.RunFnc(b)})})},c.Filter=function(){c.LoadMore(!0)},c.ChangeType=function(a){c.Type=a,c.Items=[],c.LoadMore(!0)},c.LoadMore(!0),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.LoadMoreCount<5&&c.IsLoading==0&&(c.LoadMore(),c.LoadMoreCount++)}),c.ClickGA=function(a,b){window.ga&&a.IsAds&&ga("ads.send","event",b,"Click",a.Title)},c.ImpressionGa=function(a,b){window.ga&&a.IsAds&&ga("ads.send","event",b,"Impression",a.Title)}}"use strict",angular.module("FoodyApp").controller("WishListCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","Helper","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f,g,h,i){var j=this;j.$scope=c,c.MenuId=d.MenuId?d.MenuId:1,c.Type=d.type?d.type:1,c.IsBooking=d.IsBooking?!0:null,c.IsDelivery=d.IsDelivery?!0:null,c.IsDelivery&&(c.Type=6),c.IsBooking&&(c.Type=7),c.LstDealCountDownCalled=[],c.PreloadList=[1,2,3,4,5,6],c.IsHideDealTab=!1,c.IsHideFeaturedTab=!1,c.DistrictId="",c.CateId="",c.IsReputation="",c.CuisineId="",c.NoLoadMore=!1,c.Count=12,c.LastId=null,c.Total=0,c.LoadMoreCount=0,c.Page=0,c.Items=[],c.IsLoading=!1,c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.ScrollTop=function(){var a=$(".home2-panel-right"),b=$(".home2-panel-right .foody-toolbar:visible").height();f.ScrollShowTop(a,-b)},c.setupSupportLocation=function(a){c.$apply(function(){c.Lat=a.coords.latitude,c.Lon=a.coords.longitude}),$.cookie("_pos.coords",c.Lat+"-"+c.Lon,{path:"/"})},c.unsupportLocation=function(){c.Lat=window.defaultLatgitude?defaultLatgitude:0,c.Lon=window.defaultLongitude?defaultLongitude:0,alert("We cant detect your current location!"),location.reload()},c.getData=function(b,d){b==1&&(c.Count=12,c.LastId=null,c.ExcludeIds=null,c.Page=0,c.Lat=window.defaultLatgitude?defaultLatgitude:0,c.Lon=window.defaultLongitude?defaultLongitude:0),c.IsLoading=!0;var e="/__get/Place/HomeListPlace";e+=f.GetParamRnd(e),c.IsReputation=c.IsReputation==0?"":c.IsReputation;if(c.Type==3)c.Page+=1,navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(b){c.setupSupportLocation(b),e+="&"+f.GetUrlParams({page:c.Page,lat:c.Lat,lon:c.Lon,count:c.Count,lastId:c.LastId,ExcludeIds:c.ExcludeIds,districtId:c.DistrictId,cateId:c.CateId,cuisineId:c.CuisineId,isReputation:c.IsReputation,isBooking:c.IsBooking,isDelivery:c.IsDelivery,type:c.Type}),a.get(e).success(function(a){if(!a||a.error){c.IsLoading=!1;return}d(a)}).error(function(a){f.Log(a),c.IsLoading=!1})},function(){c.unsupportLocation()});else if(c.IsDelivery&&c.Type==6){var g="/__get/Delivery/HomeListDeals";g+="?"+f.GetUrlParams({requestCount:50,type:"",nextItemId:c.LastId,masterRoot:1,rootCate:""}),a.get(g).success(function(a){if(!a||a.error){c.IsLoading=!1;return}var e={Items:[]};e.Count=a.ResultCount,e.CityId=a.CityId,e.Total=a.TotalCount,e.LastId=a.NextItemId,a.lsDeliveryOffer!=null&&a.lsDeliveryOffer.length>0?e.Items=a.lsDeliveryOffer:(c.Type=1,c.IsHideDealTab=!0,c.getData(b,d)),d(e)}).error(function(a){})}else c.Page+=1,e+="&"+f.GetUrlParams({page:c.Page,lat:c.Lat,lon:c.Lon,count:c.Count,lastId:c.LastId,ExcludeIds:c.ExcludeIds,districtId:c.DistrictId,cateId:c.CateId,cuisineId:c.CuisineId,isReputation:c.IsReputation,isBooking:c.IsBooking,isDelivery:c.IsDelivery,type:c.Type}),a.get(e).success(function(a){if(!a||a.error){c.IsLoading=!1;return}c.IsBooking&&c.Type==7&&a.Items.length==0&&(c.Type=1,c.IsHideFeaturedTab=!0,c.getData(b,d)),d(a)}).error(function(a){f.Log(a),c.IsLoading=!1})},c.bindData=function(a,b,d){a==1&&(c.Items=[],c.$parent.IsFirstLoad==0&&c.ScrollTop(),c.LoadMoreCount=0),c.$parent.IsFirstLoad=!1,c.Type!=3&&(c.Count=b.Count,c.LastId=b.LastId),c.Total=b.Total,c.CityId=b.CityId;for(var e=0;e<b.Items.length;e++)c.Items.push(b.Items[e]);c.Type==1&&(c.ExcludeIds=b.ExcludeIds),b.Items.length==0?c.NoLoadMore=!0:c.NoLoadMore=!1,f.RunFnc(d,b)},c.Init=function(a){if(!a)return;c.ChangeType(a.Type)},c.LoadMore=function(a,b){c.LoadMoreCount>=5?i.Show(function(d){d.LoggedIn&&c.LoadData(a,b)}):c.LoadData(a,b)},c.LoadData=function(a,b){if(c.IsLoading==1||!a&&c.IsLoadMore()!=1)return;c.IsLoading=!0,c.getData(a,function(d){c.bindData(a,d,function(){c.IsLoading=!1,f.RunFnc(b,d)})})},c.Filter=function(){c.LoadMore(!0)},c.ChangeType=function(a){a==5?i.Show(function(b){b.LoggedIn&&c.Predefine(a)}):c.Predefine(a)},c.Predefine=function(a){c.NoLoadMore=!1,c.Items=[],c.Type=a,c.DistrictId="",c.CateId="",c.IsReputation="",c.CuisineId="",c.LoadMore(!0)},c.LoadMore(!0),b.$broadcast("main.cate",{MenuId:c.MenuId}),c.$on("main.scroll",function(a,b){c.IsLoading==0&&c.LoadMoreCount<5&&c.IsLoadMore()==1&&c.NoLoadMore==0&&c.LoadMore(!1,function(){c.LoadMoreCount++})}),c.ShowPopupGallery=function(a){g.Show(a)},c.ShowPopupReviews=function(a){h.Show(a)},c.ClickGA=function(a,b,c,d,e){var f=$(e).text();window.ga&&a.IsAds&&((c+1)%2==0&&ga("ads.send","event",b+(c+1),"Click",a.Name),(c+1)%2!=0&&d!=""&&ga("ads.send","event",b+"["+(c+1)+"]"+"_["+f+"]","Click",a.Name))},c.ImpressionGa=function(a,b,c,d,e){var f=$(e).text();window.ga&&a.IsAds&&((c+1)%2==0&&ga("ads.send","event",b+"["+(c+1)+"]","Impression",a.Name),(c+1)%2!=0&&d!=""&&ga("ads.send","event",b+"["+(c+1)+"]"+"_["+f+"]","Impression",a.Name))},c.StartCountDown=function(a,b){if(c.LstDealCountDownCalled.indexOf(b)===-1){c.LstDealCountDownCalled.push(b),a=parseInt(a);var d=Math.floor(a/3600);a-=d*3600;var e=Math.floor(a/60)%60;a-=e*60;var f=a%60;start_counting_down(d,e,f,"txt_h_"+b,"txt_m_"+b,"txt_s_"+b)}},c.ShowPCC=function(){if($.cookie("hide-pcc")!="true"&&d.MenuId==1){var a=$("#popup-choose-category").bPopup({followSpeed:0,modalClose:!1,escClose:!1});$("#popup-choose-category a").click(function(){$.cookie("hide-pcc",!0),a.close()})}},c.ShowPCC()}"use strict",angular.module("FoodyApp").controller("PlaceCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","DlgCommon","Helper","DlgGallery","DlgReviews","DlgLogin"]})()
;(function(){function a(a,b,c,d,e,f,g){var h=this;h.$scope=a,a.MenuId=1,a.IsLoading=!1,a.IsFirstLoad=!0,a.$on("main.cate",function(b,c){a.MenuId=c.MenuId}),$(window).scroll(function(){h.timeOutScroll&&clearTimeout(h.timeOutScroll),h.timeOutScroll=setTimeout(function(){var a=$(window).scrollTop(),c=$(".home2-panel-view").height(),d=$(".home2-panel-view").offset();c>0&&a+d.top>c&&b.$broadcast("main.scroll",{})},10)}),b.ServiceRedirect=function(a){var b=window.open(a,"_blank");b.focus()}}"use strict",angular.module("FoodyApp").controller("MainCtrl",a),a.$inject=["$scope","$rootScope","$route","$routeParams","$location","$element","Helper"]})()
;(function(){function a(a,b,c,d,e,f,g){function i(b,d){b==1&&(c.Count=5,c.LastId=null),c.IsLoading=!0;var f="/__get/NewsFeed/HomeList";f+=e.GetParamRnd(f),f+="&"+e.GetUrlParams({sortType:c.SortType,count:c.Count,lastId:c.LastId}),a.get(f).success(function(a){if(!a){c.IsLoading=!1;return}d(a)}).error(function(a){e.Log(a),c.IsLoading=!1})}function j(a,b,d){a==1&&(c.Items=[]),c.LastId=b.LastId,c.Total=b.Total;for(var f=0;f<b.Items.length;f++)b.Items[f].DisplayDate=e.DateFormat(b.Items[f].ShowDate),c.Items.push(b.Items[f]);e.RunFnc(d,b)}function k(a,b,d){if(c.CUser!=null){m(a,b,d);return}g.Show(function(c){c.LoggedIn&&o(!0,function(){m(a,b,d)})})}function l(a,b,d){if(c.CUser!=null){n(a,b,d);return}g.Show(function(c){c.LoggedIn&&o(!0,function(){n(a,b,d)})})}function m(b,c,d){var f="/__post/Comment/Like";a.post(f,{id:b,type:c}).success(function(a){if(!a||a.Error)return;e.RunFnc(d)}).error(function(a){e.Log(a)})}function n(b,c,d){var f="/__post/Comment/UnLike";a.post(f,{id:b,type:c}).success(function(a){if(!a)return;e.RunFnc(d)}).error(function(a){e.Log(a)})}function o(a,b){e.GetCurrentUser(function(a){c.CUser=a,e.RunFnc(b)},a)}var h=this;h.$scope=c,c.Count=5,c.CUser=null,c.LastId=null,c.Total=0,c.LoadMoreCount=0,c.Items=[],c.IsLoading=!1,c.PreloadList=[1,2,3],c.IsLoadMore=function(){return c.Total-c.Items.length>0},c.MenuId=d.MenuId?d.MenuId:1,b.$broadcast("main.cate",{MenuId:c.MenuId}),c.Init=function(){c.SortType=1,o(!0),c.LoadData(!0)},c.ChangeType=function(a){c.SortType=a,c.Items=[],c.LoadData(!0)},c.LoadData=function(a,b){if(c.IsLoading==1)return;c.IsLoading=!0,i(a,function(d){j(a,d,function(){c.IsLoading=!1,e.RunFnc(b)})})},c.Link=function(b){var c="/__post/NewsFeed/UpdateTotalViews",d=e.GetParamRnd(c);a.post(c,{id:b}).success(function(a){}).error(function(a){e.Log(a)})},c.ShowDetail=function(a){f.Show(a)},c.TbLike=function(a){a.IsLiked?l(a.Id,20,function(){a.IsLiked=!1,a.TotalLike--}):k(a.Id,20,function(){a.IsLiked=!0,a.TotalLike++})},c.$on("main.scroll",function(a,b){c.IsLoading==0&&c.IsLoadMore()==1&&c.LoadData(!1,function(){})})}"use strict",angular.module("FoodyApp").controller("HomeNewsFeedCtrl",a),a.$inject=["$http","$rootScope","$scope","$routeParams","Helper","DlgNewsFeed","DlgLogin"]})()